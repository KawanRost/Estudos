!pip install pdfplumber #instalando biblioteca pdfplumber

import pdfplumber as pdf_pl #importando biblioteca

arquivo = "TabelaDebitosJudiciais.pdf" #fonte: https://www.tjsp.jus.br/Download/Tabelas/TabelaDebitosJudiciais.pdf

pdf = pdf_pl.open(arquivo) #Abrindo aquivo

import pandas as pd #importando biblioteca

p = pdf.pages[0] # possui 4 tabelas (0 a 3) >>>>>>> acessando a pagina 1 do aquivo pdf
p2 = pdf.pages[1]  # possui 3 tabelas (0 a 2) >>>>>>> acessando a pagina 2 do aquivo pdf

imagem = p.extract_tables()     #Extraindo tabelas do PDF conforme pagina
imagem2 = p2.extract_tables()     #Extraindo tabelas do PDF conforme pagina

df1 = pd.DataFrame(imagem)      #Transformando tabela extraida em DataFrame
df2 = pd.DataFrame(imagem2)

tamanho_pg1 = len(imagem1) # verificando quantidade de tabelas em cada pagina
tamanho_pg2 = len(imagem2) # verificando quantidade de tabelas em cada pagina

dfmult1 = pd.DataFrame(imagem[0]) #criando df com primeira tabela da pagina 1
dfmult2 = pd.DataFrame(imagem2[0]) #criando df com primeira tabela da pagina2

# criando loop for para incluir as demais tabelas da pagina dentro do df1
for i in range(0, tamanho1):
  df1 = pd.DataFrame(imagem[i])
  m = pd.merge(dfmult1, df1, how = 'outer')
    # atualizando dfmult1 com a variavel m, que consolidou todas as tabelas da pg1 do arquivo em um unico df
    dfmult1 = m

# criando loop for para incluir as demais tabelas da pagina dentro do df2
for i in range(0, tamanho2):
  df2 = pd.DataFrame(imagem2[i])
  m2 = pd.merge(dfmult2, df2, how = 'outer')
    # atualizando dfmult1 com a variavel m2, que consolidou todas as tabelas da pg2 do arquivo em um unico df
    dfmult2 = m2

# efetuando ultima consolidação de df, no caso pg1 e pg2
m3 = pd.merge(m, m2, how = 'outer')

#salvando aquivo em excel
m3.to_excel("./arquivo.xlsx")
